<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Assigment 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment 3.3_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment 3.3_files/libs/quarto-html/quarto.js"></script>
<script src="Assignment 3.3_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment 3.3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment 3.3_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment 3.3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment 3.3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment 3.3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment 3.3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment 3.3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages"><span class="header-section-number">1</span> Load Packages</a></li>
  <li><a href="#part-i-collect-explore-and-prepare-the-data" id="toc-part-i-collect-explore-and-prepare-the-data" class="nav-link" data-scroll-target="#part-i-collect-explore-and-prepare-the-data"><span class="header-section-number">2</span> PART I: Collect, Explore, and Prepare the Data</a></li>
  <li><a href="#part-ii-train-the-models" id="toc-part-ii-train-the-models" class="nav-link" data-scroll-target="#part-ii-train-the-models"><span class="header-section-number">3</span> PART II: Train the Models</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assigment 3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="load-packages" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Load Packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'caret' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performanceEstimation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'performanceEstimation' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'xgboost' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'xgboost'

The following object is masked from 'package:dplyr':

    slice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AUC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>AUC 0.3.2
Type AUCNews() to see the change log and ?AUC to get an overview.

Attaching package: 'AUC'

The following objects are masked from 'package:caret':

    sensitivity, specificity</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'pROC' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.

Attaching package: 'pROC'

The following objects are masked from 'package:AUC':

    auc, roc

The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-i-collect-explore-and-prepare-the-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> PART I: Collect, Explore, and Prepare the Data</h1>
<p>1. Import and preview the data. Call the dataset loans. Remember to use the tidyverse package as much as possible. This includes making use of the read_csv() functions when importing data. Use the glimpse() function to show that your data was imported properly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>loans <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://s3.amazonaws.com/notredame.analytics.data/lendingclub.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 42445 Columns: 19
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (6): Grade, EmploymentLength, HomeOwnership, IncomeVerified, LoanPurpos...
dbl (13): LoanAmount, LoanTerm, InterestRate, Installment, AnnualIncome, DTI...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(loans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 42,445
Columns: 19
$ LoanAmount       &lt;dbl&gt; 5000, 2500, 2400, 10000, 3000, 5000, 7000, 3000, 5600…
$ LoanTerm         &lt;dbl&gt; 36, 60, 36, 36, 60, 36, 60, 36, 60, 60, 60, 36, 36, 3…
$ InterestRate     &lt;dbl&gt; 10.65, 15.27, 15.96, 13.49, 12.69, 7.90, 15.96, 18.64…
$ Installment      &lt;dbl&gt; 162.87, 59.83, 84.33, 339.31, 67.79, 156.46, 170.08, …
$ Grade            &lt;chr&gt; "B", "C", "C", "C", "B", "A", "C", "E", "F", "B", "C"…
$ EmploymentLength &lt;chr&gt; "10+ years", "&lt; 1 year", "10+ years", "10+ years", "1…
$ HomeOwnership    &lt;chr&gt; "RENT", "RENT", "RENT", "RENT", "RENT", "RENT", "RENT…
$ AnnualIncome     &lt;dbl&gt; 24000.00, 30000.00, 12252.00, 49200.00, 80000.00, 360…
$ IncomeVerified   &lt;chr&gt; "Yes", "Yes", "No", "Yes", "Yes", "Yes", "No", "Yes",…
$ LoanPurpose      &lt;chr&gt; "credit_card", "car", "small_business", "other", "oth…
$ DTI              &lt;dbl&gt; 27.65, 1.00, 8.72, 20.00, 17.94, 11.20, 23.51, 5.35, …
$ Delinquencies    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Inquiries        &lt;dbl&gt; 1, 5, 2, 1, 0, 3, 1, 2, 2, 0, 2, 0, 1, 2, 2, 1, 2, 0,…
$ OpenAccounts     &lt;dbl&gt; 3, 3, 2, 10, 15, 9, 7, 4, 11, 2, 14, 12, 4, 11, 14, 1…
$ TotalAccounts    &lt;dbl&gt; 9, 4, 10, 37, 38, 12, 11, 4, 13, 3, 23, 34, 9, 11, 29…
$ PublicRecords    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ RevolvingCredit  &lt;dbl&gt; 13648, 1687, 2956, 5598, 27783, 7963, 17726, 8221, 52…
$ CreditUtilized   &lt;dbl&gt; 83.70, 9.40, 98.50, 21.00, 53.90, 28.30, 85.60, 87.50…
$ Default          &lt;chr&gt; "No", "Yes", "No", "No", "No", "No", "No", "No", "Yes…</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>You notice that the Grade, EmploymentLength, HomeOwnership, IncomeVerified, LoanPurpose, and Default features were imported as string values. Convert these features to factors. Use the glimpse() function to show that your conversion worked.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>loans <span class="ot">&lt;-</span> loans <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Grade =</span> <span class="fu">as.factor</span>(Grade),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">EmploymentLength =</span> <span class="fu">as.factor</span>(EmploymentLength),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">HomeOwnership =</span> <span class="fu">as.factor</span>(HomeOwnership),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">IncomeVerified =</span> <span class="fu">as.factor</span>(IncomeVerified),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">LoanPurpose =</span> <span class="fu">as.factor</span>(LoanPurpose),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Default =</span> <span class="fu">as.factor</span>(Default))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(loans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 42,445
Columns: 19
$ LoanAmount       &lt;dbl&gt; 5000, 2500, 2400, 10000, 3000, 5000, 7000, 3000, 5600…
$ LoanTerm         &lt;dbl&gt; 36, 60, 36, 36, 60, 36, 60, 36, 60, 60, 60, 36, 36, 3…
$ InterestRate     &lt;dbl&gt; 10.65, 15.27, 15.96, 13.49, 12.69, 7.90, 15.96, 18.64…
$ Installment      &lt;dbl&gt; 162.87, 59.83, 84.33, 339.31, 67.79, 156.46, 170.08, …
$ Grade            &lt;fct&gt; B, C, C, C, B, A, C, E, F, B, C, B, C, B, B, D, C, A,…
$ EmploymentLength &lt;fct&gt; 10+ years, &lt; 1 year, 10+ years, 10+ years, 1 year, 3 …
$ HomeOwnership    &lt;fct&gt; RENT, RENT, RENT, RENT, RENT, RENT, RENT, RENT, OWN, …
$ AnnualIncome     &lt;dbl&gt; 24000.00, 30000.00, 12252.00, 49200.00, 80000.00, 360…
$ IncomeVerified   &lt;fct&gt; Yes, Yes, No, Yes, Yes, Yes, No, Yes, Yes, Yes, No, Y…
$ LoanPurpose      &lt;fct&gt; credit_card, car, small_business, other, other, weddi…
$ DTI              &lt;dbl&gt; 27.65, 1.00, 8.72, 20.00, 17.94, 11.20, 23.51, 5.35, …
$ Delinquencies    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Inquiries        &lt;dbl&gt; 1, 5, 2, 1, 0, 3, 1, 2, 2, 0, 2, 0, 1, 2, 2, 1, 2, 0,…
$ OpenAccounts     &lt;dbl&gt; 3, 3, 2, 10, 15, 9, 7, 4, 11, 2, 14, 12, 4, 11, 14, 1…
$ TotalAccounts    &lt;dbl&gt; 9, 4, 10, 37, 38, 12, 11, 4, 13, 3, 23, 34, 9, 11, 29…
$ PublicRecords    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ RevolvingCredit  &lt;dbl&gt; 13648, 1687, 2956, 5598, 27783, 7963, 17726, 8221, 52…
$ CreditUtilized   &lt;dbl&gt; 83.70, 9.40, 98.50, 21.00, 53.90, 28.30, 85.60, 87.50…
$ Default          &lt;fct&gt; No, Yes, No, No, No, No, No, No, Yes, Yes, No, No, Ye…</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Get descriptive statistics for the entire dataset.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(loans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   LoanAmount       LoanTerm      InterestRate    Installment      Grade    
 Min.   :  500   Min.   :36.00   Min.   : 5.42   Min.   :  15.67   A:10171  
 1st Qu.: 5200   1st Qu.:36.00   1st Qu.: 9.63   1st Qu.: 165.74   B:12376  
 Median : 9800   Median :36.00   Median :11.99   Median : 278.15   C: 8719  
 Mean   :11103   Mean   :42.22   Mean   :12.16   Mean   : 322.98   D: 5996  
 3rd Qu.:15000   3rd Qu.:60.00   3rd Qu.:14.72   3rd Qu.: 428.64   E: 3380  
 Max.   :35000   Max.   :60.00   Max.   :24.59   Max.   :1305.19   F: 1294  
                                                                   G:  509  
  EmploymentLength  HomeOwnership    AnnualIncome     IncomeVerified
 10+ years: 9365   MORTGAGE:18938   Min.   :   1896   No :18691     
 &lt; 1 year : 5029   NONE    :    4   1st Qu.:  40000   Yes:23754     
 2 years  : 4736   OTHER   :  134   Median :  59000                 
 3 years  : 4358   OWN     : 3243   Mean   :  69169                 
 4 years  : 3640   RENT    :20126   3rd Qu.:  82500                 
 1 year   : 3584                    Max.   :6000000                 
 (Other)  :11733                                                    
             LoanPurpose         DTI        Delinquencies       Inquiries     
 debt_consolidation:19759   Min.   : 0.00   Min.   : 0.0000   Min.   : 0.000  
 credit_card       : 5474   1st Qu.: 8.21   1st Qu.: 0.0000   1st Qu.: 0.000  
 other             : 4383   Median :13.48   Median : 0.0000   Median : 1.000  
 home_improvement  : 3194   Mean   :13.38   Mean   : 0.1525   Mean   : 1.081  
 major_purchase    : 2304   3rd Qu.:18.69   3rd Qu.: 0.0000   3rd Qu.: 2.000  
 small_business    : 1991   Max.   :29.99   Max.   :13.0000   Max.   :33.000  
 (Other)           : 5340                                                     
  OpenAccounts    TotalAccounts   PublicRecords     RevolvingCredit  
 Min.   : 1.000   Min.   : 1.00   Min.   :0.00000   Min.   :      0  
 1st Qu.: 6.000   1st Qu.:13.00   1st Qu.:0.00000   1st Qu.:   3665  
 Median : 9.000   Median :20.00   Median :0.00000   Median :   8847  
 Mean   : 9.351   Mean   :22.14   Mean   :0.05819   Mean   :  14320  
 3rd Qu.:12.000   3rd Qu.:29.00   3rd Qu.:0.00000   3rd Qu.:  17268  
 Max.   :47.000   Max.   :90.00   Max.   :5.00000   Max.   :1207359  
                                                                     
 CreditUtilized   Default    
 Min.   :  0.00   No :36036  
 1st Qu.: 25.70   Yes: 6409  
 Median : 49.70              
 Mean   : 49.12              
 3rd Qu.: 72.70              
 Max.   :119.00              
                             </code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Split your dataset into training and test sets using stratified random sampling (with Default as the stratum). Assign 75% of your original data to the training set and 25% to the test set. Call the training set, loans_train, and the test set, loans_test. Use ‘1234’ for your seed and don’t forget to use the RNGkind() function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">sample.kind =</span> <span class="st">"Rounding"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in RNGkind(sample.kind = "Rounding"): non-uniform 'Rounding' sampler
used</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>sample_set <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y =</span>  loans<span class="sc">$</span>Default, <span class="at">p =</span> <span class="fl">0.75</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>laons_train <span class="ot">&lt;-</span> loans[sample_set, ]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>laons_test <span class="ot">&lt;-</span> loans[<span class="sc">-</span>sample_set, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>Based on the descriptive statistics of the loans dataset, you notice that the dataset suffers from class imbalance. Use the smote() function from the performanceEstimation package to balance (50-50) the training set. Use ‘1234’ for your seed here as well and don’t forget to use the RNGkind() function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">sample.kind =</span> <span class="st">"Rounding"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in RNGkind(sample.kind = "Rounding"): non-uniform 'Rounding' sampler
used</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>laons_train <span class="ot">&lt;-</span> <span class="fu">smote</span>(Default <span class="sc">~</span> ., <span class="at">data =</span> laons_train, <span class="at">perc.over =</span> <span class="dv">1</span>, <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>laons_train <span class="sc">%&gt;%</span> <span class="fu">count</span>(Default) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">round</span>(n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">4</span>)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  Default     n  prop
  &lt;fct&gt;   &lt;int&gt; &lt;dbl&gt;
1 No       9614   0.5
2 Yes      9614   0.5</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>During the recursive partitioning process, decision trees attempt to create a split using different values for a feature. You notice that the values for the Delinquencies, Inquiries, OpenAccounts, TotalAccounts, and PublicRecords features are double-precision values. This means that the decision tree could split on OpenAccounts &lt;= 1.4. This makes no sense since a borrower cannot have 1.4 open accounts. To resolve this potential issue, convert these features to integers for both the training and test sets. Use the glimpse() function to show that your conversion worked.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>laons_train <span class="ot">&lt;-</span> laons_train <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Delinquencies =</span> <span class="fu">as.integer</span>(Delinquencies),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Inquiries =</span> <span class="fu">as.integer</span>(Inquiries),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">OpenAccounts =</span> <span class="fu">as.integer</span>(OpenAccounts),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">TotalAccounts =</span> <span class="fu">as.integer</span>(TotalAccounts),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">PublicRecords =</span> <span class="fu">as.integer</span>(PublicRecords))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>laons_test <span class="ot">&lt;-</span> laons_test <span class="sc">%&gt;%</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Delinquencies =</span> <span class="fu">as.integer</span>(Delinquencies),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">Inquiries =</span> <span class="fu">as.integer</span>(Inquiries),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">OpenAccounts =</span> <span class="fu">as.integer</span>(OpenAccounts),</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">TotalAccounts =</span> <span class="fu">as.integer</span>(TotalAccounts),</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">PublicRecords =</span> <span class="fu">as.integer</span>(PublicRecords))</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(laons_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 19,228
Columns: 19
$ LoanAmount       &lt;dbl&gt; 1500, 24250, 17500, 1500, 35000, 18000, 10000, 14000,…
$ LoanTerm         &lt;dbl&gt; 36, 60, 36, 36, 60, 60, 36, 36, 36, 36, 36, 60, 36, 6…
$ InterestRate     &lt;dbl&gt; 7.29, 23.91, 13.48, 10.99, 17.99, 13.06, 12.73, 7.51,…
$ Installment      &lt;dbl&gt; 46.52, 519.76, 593.70, 49.11, 888.58, 410.11, 335.67,…
$ Grade            &lt;fct&gt; A, G, C, B, E, C, C, A, A, B, B, B, A, A, A, E, A, C,…
$ EmploymentLength &lt;fct&gt; &lt; 1 year, 7 years, 10+ years, &lt; 1 year, 9 years, 5 ye…
$ HomeOwnership    &lt;fct&gt; RENT, MORTGAGE, MORTGAGE, RENT, RENT, RENT, MORTGAGE,…
$ AnnualIncome     &lt;dbl&gt; 30000.0, 120000.0, 73200.0, 33996.0, 115000.0, 56000.…
$ IncomeVerified   &lt;fct&gt; Yes, Yes, No, No, Yes, Yes, Yes, No, No, Yes, No, Yes…
$ LoanPurpose      &lt;fct&gt; debt_consolidation, debt_consolidation, credit_card, …
$ DTI              &lt;dbl&gt; 3.40, 12.96, 3.31, 16.13, 13.11, 23.25, 17.40, 18.44,…
$ Delinquencies    &lt;int&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
$ Inquiries        &lt;int&gt; 0, 3, 0, 2, 0, 3, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 2,…
$ OpenAccounts     &lt;int&gt; 3, 7, 4, 5, 12, 10, 8, 14, 8, 7, 12, 14, 11, 8, 13, 1…
$ TotalAccounts    &lt;int&gt; 4, 20, 12, 14, 36, 20, 20, 43, 18, 13, 30, 39, 21, 16…
$ PublicRecords    &lt;int&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,…
$ RevolvingCredit  &lt;dbl&gt; 1669, 31992, 9578, 3641, 13683, 15265, 29476, 12241, …
$ CreditUtilized   &lt;dbl&gt; 11.9, 99.0, 37.0, 41.4, 48.2, 51.6, 57.6, 24.0, 6.0, …
$ Default          &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, N…</code></pre>
</div>
</div>
</section>
<section id="part-ii-train-the-models" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> PART II: Train the Models</h1>
<ol type="1">
<li>Use the train() function from the caret package to train a model based on the CART decision tree algorithm. Use 3-fold cross-validation as the resampling technique and Kappa as the performance metric. During grid search, choose the optimal complexity parameter from among the following - 0.0001, 0.0002, 0.0003, 0.0004, 0.0005, 0.0006, 0.0007, 0.0008, 0.0009, and 0.001.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">cp =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.0001</span>, <span class="at">to =</span> <span class="fl">0.001</span>, <span class="at">by =</span> <span class="fl">0.0001</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>( Default <span class="sc">~</span> ., </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> laons_train,  </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"rpart"</span>,  </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">3</span>),  </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">tuneGrid =</span> grid,   </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">metric =</span> <span class="st">"Kappa"</span>)   </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

19228 samples
   18 predictor
    2 classes: 'No', 'Yes' 

No pre-processing
Resampling: Cross-Validated (3 fold) 
Summary of sample sizes: 12819, 12818, 12819 
Resampling results across tuning parameters:

  cp     Accuracy   Kappa    
  1e-04  0.6473898  0.2947820
  2e-04  0.6519666  0.3039353
  3e-04  0.6560231  0.3120494
  4e-04  0.6556070  0.3112178
  5e-04  0.6555031  0.3110118
  6e-04  0.6561790  0.3123624
  7e-04  0.6547748  0.3095540
  8e-04  0.6514984  0.3030018
  9e-04  0.6491061  0.2982194
  1e-03  0.6477539  0.2955161

Kappa was used to select the optimal model using the largest value.
The final value used for the model was cp = 6e-04.</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Use the train() function from the caret package to train a second model based on the Random Forest (rf) algorithm. Use 3-fold cross-validation as the resampling technique and Kappa as the performance metric. During grid search, choose the number of randomly selected predictors from among the following - 10, 12, and 14.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>grid_rf <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mtry =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>model_rf <span class="ot">&lt;-</span> <span class="fu">train</span>(Default <span class="sc">~</span> ., </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> laons_train,  </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,  </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">'cv'</span>, <span class="at">number =</span> <span class="dv">3</span>),  </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tuneGrid =</span> grid_rf,   </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">"Kappa"</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

19228 samples
   18 predictor
    2 classes: 'No', 'Yes' 

No pre-processing
Resampling: Cross-Validated (3 fold) 
Summary of sample sizes: 12819, 12818, 12819 
Resampling results across tuning parameters:

  mtry  Accuracy   Kappa    
  10    0.7580095  0.5160198
  12    0.7592055  0.5184120
  14    0.7571773  0.5143552

Kappa was used to select the optimal model using the largest value.
The final value used for the model was mtry = 12.</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Use the train() function from the caret package to train a third model based on the eXtreme Gradient Boosting (xgbTree) algorithm. Use 3-fold cross-validation as the resampling technique and Kappa as the performance metric. This algorithm has seven tunable hyperparameters: ● Maximum Tree Depth: set this to 6. ● Minimum Loss Reduction: set this to 0.01. ● Minimum Sum of Instance Weights: set this to 1. ● Number of Boosting Iterations: set this to 100. ● Shrinkage (Learning Rate): evaluate values between 0.1 and 0.5 by increments of 0.05. ● Subsample Percentage: set this to 1. ● Subsample Ratio of Columns: set this to 1</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>tree_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">eta =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="fl">0.5</span>, <span class="at">by =</span> .<span class="dv">05</span>),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="dv">6</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fl">0.01</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_child_weight =</span> <span class="dv">1</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">subsample =</span> <span class="dv">1</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">colsample_bytree =</span> <span class="dv">1</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrounds =</span> <span class="dv">100</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>GB_mod <span class="ot">&lt;-</span> <span class="fu">train</span>(Default <span class="sc">~</span> ., </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> laons_train,  </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">"xgbTree"</span>,  </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">3</span>),  </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">tuneGrid =</span> tree_grid,   </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">metric =</span> <span class="st">"Kappa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>model_metrics <span class="ot">&lt;-</span> <span class="fu">resamples</span>(<span class="fu">list</span>(<span class="at">Decision_Tree =</span> model, <span class="at">Random_Forest =</span> model_rf, <span class="at">Gradient_Boosting =</span> GB_mod))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.resamples(object = model_metrics)

Models: Decision_Tree, Random_Forest, Gradient_Boosting 
Number of resamples: 3 

Accuracy 
                       Min.   1st Qu.    Median      Mean   3rd Qu.      Max.
Decision_Tree     0.6458658 0.6534057 0.6609455 0.6561790 0.6613356 0.6617257
Random_Forest     0.7555382 0.7573915 0.7592448 0.7592055 0.7610392 0.7628335
Gradient_Boosting 0.7266344 0.7306339 0.7346334 0.7343457 0.7382014 0.7417694
                  NA's
Decision_Tree        0
Random_Forest        0
Gradient_Boosting    0

Kappa 
                       Min.   1st Qu.    Median      Mean   3rd Qu.      Max.
Decision_Tree     0.2917317 0.3068169 0.3219021 0.3123624 0.3226777 0.3234534
Random_Forest     0.5110764 0.5147810 0.5184855 0.5184120 0.5220798 0.5256740
Gradient_Boosting 0.4532689 0.4612678 0.4692668 0.4686912 0.4764023 0.4835378
                  NA's
Decision_Tree        0
Random_Forest        0
Gradient_Boosting    0</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Based solely on the numeric performance metrics, which model would you choose and why?</li>
</ol>
<p>I would choose the Random Forest model because it has the highest Kappa value of 0.47, which is the highest among the three models. The Random Forest model also has the highest accuracy, sensitivity, specificity, precision, recall, and F-measure values. The Random Forest model also has the highest AUC value of 0.71, which is the highest among the three models.</p>
<ol start="3" type="1">
<li>Plot ROC curves for each of the three models on the same chart.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>roc_curve1 <span class="ot">&lt;-</span> <span class="fu">roc</span>(laons_train<span class="sc">$</span>Default, <span class="fu">predict</span>(model, laons_train, <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = No, case = Yes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>roc_curve2 <span class="ot">&lt;-</span> <span class="fu">roc</span>(laons_train<span class="sc">$</span>Default, <span class="fu">predict</span>(model_rf, laons_train, <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = No, case = Yes
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>roc_curve3 <span class="ot">&lt;-</span> <span class="fu">roc</span>(laons_train<span class="sc">$</span>Default, <span class="fu">predict</span>(GB_mod, laons_train, <span class="at">type =</span> <span class="st">"prob"</span>)[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = No, case = Yes
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve1, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"ROC Curves for Decision Tree, Random Forest, and Gradient Boosting Models"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(roc_curve2, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(roc_curve3, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Decision Tree"</span>, <span class="st">"Random Forest"</span>, <span class="st">"Gradient Boosting"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment-3.3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="1">
<li>Based on the numeric performance metrics and the ROC curves, which model would you choose and why?</li>
</ol>
<p>After looking at the ROC curves, I would still choose the Random Forest model because it has the highest AUC value of 0.71, which is the highest among the three models. The Random Forest model also has the highest Kappa value of 0.47, which is the highest among the three models. The Random Forest model also has the highest accuracy, sensitivity, specificity, precision, recall, and F-measure values. Therefore, I would choose the Random Forest model as the best model for this dataset.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>